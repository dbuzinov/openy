!function(w,d){var atc_url="//addtocalendar.com/atc/",atc_version="1.5",b=d.documentElement;Array.prototype.map||(Array.prototype.map=function(e){for(var t=[],a=0,n=this.length;a<n;a++)t.push(e(this[a]));return t});var isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunc=function(e){return"[object Function]"===Object.prototype.toString.call(e)},ready=function(e,t){function a(){if(!i){if(!t.body)return setTimeout(a,13);if(i=!0,c){for(var e,n=0;e=c[n++];)e.call(null);c=null}}}function n(){if(!d){if(d=!0,"complete"===t.readyState)return a();if(t.addEventListener)t.addEventListener("DOMContentLoaded",r,!1),e.addEventListener("load",a,!1);else if(t.attachEvent){t.attachEvent("onreadystatechange",r),e.attachEvent("onload",a);var n=!1;try{n=null==e.frameElement}catch(e){}b.doScroll&&n&&o()}else l=e.onload,e.onload=function(e){l(e),a()}}}function o(){if(!i){try{b.doScroll("left")}catch(e){return void setTimeout(o,1)}a()}}var r,l,i=!1,d=!1,c=[];return t.addEventListener?r=function(){t.removeEventListener("DOMContentLoaded",r,!1),a()}:t.attachEvent&&(r=function(){"complete"===t.readyState&&(t.detachEvent("onreadystatechange",r),a())}),function(e){n(),i?e.call(null):c.push(e)}}(w,d);w.addtocalendar&&"function"==typeof w.addtocalendar.start||(w.addtocalendar||(w.addtocalendar={}),addtocalendar.languages={de:"In den Kalender",en:"Add to Calendar",es:"Añadir al Calendario",fr:"Ajouter au calendrier",hi:"कैलेंडर में जोड़ें",in:"Tambahkan ke Kalender",ja:"カレンダーに追加",ko:"캘린더에 추가",pt:"Adicionar ao calendário",ru:"Добавить в календарь",uk:"Додати в календар",zh:"添加到日历"},addtocalendar.calendar_urls={},addtocalendar.loadSettings=function(element){var settings={language:"auto","show-list-on":"click",calendars:["iCalendar","Google Calendar","Outlook","Outlook Online","Yahoo! Calendar"],secure:"auto","on-button-click":function(){},"on-calendar-click":function(){}};for(var option in settings){var pname="data-"+option,eattr=element.getAttribute(pname);if(null!=eattr){if(isArray(settings[option])){settings[option]=eattr.replace(/\s*,\s*/g,",").replace(/^\s+|\s+$/g,"").split(",");continue}if(isFunc(settings[option])){var fn=window[eattr];isFunc(fn)?settings[option]=fn:settings[option]=eval("(function(mouseEvent){"+eattr+"})");continue}settings[option]=element.getAttribute(pname)}}return settings},addtocalendar.load=function(){ready(function(){for(var e={iCalendar:"ical","Google Calendar":"google",Outlook:"outlook","Outlook Online":"outlookonline","Yahoo! Calendar":"yahoo"},t=-(new Date).getTimezoneOffset().toString(),a=addtocalendar.languages,n=document.getElementsByTagName("*"),o=0;o<n.length;o++){var r=n[o].className;n[o].tagName;if(r.length&&r.match(/addtocalendar/g)){var l=addtocalendar.loadSettings(n[o]),i=1==l.calendars.length,d="http:";"auto"==l.secure?d="https:"==location.protocol?"https:":"http:":"true"==l.secure&&(d="https:");var c=n[o].id,s=a.en;if("auto"==l.language){var u="no_lang";"string"==typeof navigator.language?u=navigator.language.substr(0,2):"string"==typeof navigator.browserLanguage&&(u=navigator.browserLanguage.substr(0,2)),a.hasOwnProperty(u)&&(s=a[u])}else a.hasOwnProperty(l.language)&&(s=a[l.language]);for(var g=["utz="+t,"uln="+navigator.language,"vjs="+atc_version],f=n[o].getElementsByTagName("var"),p=-1,m=0;m<f.length;m++){var v=f[m].className.replace("atc_","").split(" ")[0],h=f[m].innerHTML;"event"!=v?v!=f[m].className?-1!=p&&g.push("e["+p+"]["+v+"]="+encodeURIComponent(h)):"atc-body"==v&&(s=h):p++}var y=""==c?"":c+"_link",b=document.createElement("ul");b.className="atcb-list";var k="",E="";for(var w in l.calendars)if(e.hasOwnProperty(l.calendars[w])){var C=e[l.calendars[w]],L=""==c?"":'id="'+c+"_"+C+'_link"',O=("ical"==C&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream?"https:":d)+atc_url+C+"?"+g.join("&");i?E=O:k+='<li class="atcb-item"><a '+L+' class="atcb-item-link" href="'+O+'" target="_blank">'+l.calendars[w]+"</a></li>"}if(b.innerHTML=k,void 0==n[o].getElementsByClassName("atcb-link")[0])(N=document.createElement("a")).className="atcb-link",N.innerHTML=s,N.id=y,N.tabIndex=1,i&&(N.href=E,N.target="_blank"),n[o].appendChild(N),i||n[o].appendChild(b);else{var N=n[o].getElementsByClassName("atcb-link")[0];i||N.parentNode.appendChild(b),N.tabIndex=1,""==N.id&&(N.id=y),i&&(N.href=E,N.target="_blank")}n[o].getElementsByClassName("atcb-link")[0].addEventListener("click",l["on-button-click"],!1);for(var _=n[o].getElementsByClassName("atcb-item-link"),m=0;m<_.length;m++)_[m].addEventListener("click",l["on-calendar-click"],!1)}}})},addtocalendar.load())}(window,document);
