<div id="component_$component_id" class="$component_type">
	[[ if months ]]
	$start_loop_months
	<p class="month_year"><a href="$blog_post_listing_url">$pub_display_month $pub_year[[ if display_post_count ]] ($post_count)[[ end if display_post_count ]]</a></p>
	$end_loop_months
	[[ end if months ]]
	[[ if years ]]
	<div>
	$start_loop_years
		<ul class="blog_years_list">
			<li class="blog_year_li"><a href="#" class="blog_year_link"><i class="glyphicon glyphicon-plus-sign"></i>$year_esc</a></li>
			<li class="blog_months_container_li" id="blog_archive_year_$year_esc">
				<ul class="blog_months_list">
					$start_loop_posts
					<li class="blog_month_li"><a href="$blog_post_listing_url" class="blog_month_link" id="blog_archive_month_$year_esc\_$pub_month">$pub_display_month[[ if display_post_count ]] ($post_count)[[ end if display_post_count ]]</a></li>
					$end_loop_posts
				</ul>
			</li>
		</ul>
	$end_loop_years
	</div>
[[ end if years ]]
</div>

<script language="JavaScript" type="text/javascript">
	function getUrlVars() {
		var vars = {};
		var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
			vars[key] = value;
		});
		return vars;
	}


	CWjQuery( function() {
		var url_vars = getUrlVars(),
				blog_archive_active = false,
				blog_archive_month,
				blog_archive_year;

		if( typeof url_vars["month"] != "undefined" ) {
			blog_archive_month  = url_vars["month"];
			blog_archive_year   = url_vars["year"];
		}
		else {
			var path_split = window.location.pathname.split("/");
			blog_archive_month  = path_split[path_split.length-2];
			blog_archive_year   = path_split[path_split.length-3];
		}

		var component_id = '$component_id_esc_js';
		var component_el = CWjQuery("#component_" + component_id);

		var blog_current_year_el = component_el.find("#blog_archive_year_" + blog_archive_year);
		blog_current_year_el.css({"display": "block"});
		blog_current_year_el.prevAll('.blog_year_li').addClass("expanded")
				.find('.blog_year_link > i').removeClass('glyphicon-plus-sign').addClass('glyphicon-minus-sign');
		component_el.find("#blog_archive_month_" + blog_archive_year + "_" + blog_archive_month).addClass("active");

		component_el.find('.blog_year_link').on('click', function(e) {
			e.preventDefault();
			var el = CWjQuery(this);
			var year_li = el.parents('.blog_year_li');
			year_li.nextAll('.blog_months_container_li').first().slideToggle('fast');
			if( year_li.hasClass("expanded") ) {
				year_li.find('.blog_year_link > i').removeClass('glyphicon-minus-sign').addClass('glyphicon-plus-sign');
				year_li.removeClass("expanded");
			}
			else {
				year_li.find('.blog_year_link > i').removeClass('glyphicon-plus-sign').addClass('glyphicon-minus-sign');
				year_li.addClass("expanded");
			}
		});
	});
</script>