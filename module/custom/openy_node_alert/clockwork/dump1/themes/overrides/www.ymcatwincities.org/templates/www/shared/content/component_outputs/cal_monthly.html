<script type="text/javascript">
<!--

mode = '$mode';

function show_event_detail( event_id, detail_link ) {

	if( detail_link != '' ) {
		window.location = detail_link;
	} else {
		if( mode == 'preview' ) {
			url = '$base_url/cal/display_event_detail.php?event_id=' + event_id;
		} else {
			url = '/mastercal/event_detail/' + event_id + '.html';
		}
		var popup_width=380;
		var popup_height=520;
		var left_edge = screen.availWidth - popup_width - 230;
		popup = window.open( url , "event_detail_popup",
                    "toolbar=yes,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes," 
					+ "width=" + popup_width + ",height=" + popup_height + ",left=" + left_edge);
		popup.focus();
	}
}


function change_month( action ) {

	month = document.forms['cal_monthly_form'].month.value;
	year = document.forms['cal_monthly_form'].year.value;
	switch( action ) {
		case 'previous':
			month--;
			if( month < 1 ) {
				month += 12;
				year--;
			}
			break;
		case 'next':
			month++;
			if( month > 12 ) {
				month -= 12;
				year++;
			}
			break;
		case 'select':
			break;
	}			

	document.forms['cal_monthly_form'].month.value = month;
	document.forms['cal_monthly_form'].year.value = year;
	document.forms['cal_monthly_form'].submit();

}

-->
</script>
			<table valign="top" width="100%" border="0" cellpadding="2" cellspacing="1" class="calgrid">
				<tr align="center" class="calnavrow">
			   		<td colspan="7" valign="top" align="center">
						<form name="cal_monthly_form" method="$form_method">
							$preview_parameters
							<a href="javascript:change_month( 'previous' )" class="calbutton">&lt;&lt; Previous</a>
							<select NAME="month" onChange="change_month( 'select' )">
						        <option value="1" $month_01_selected>January</option>
						        <option value="2" $month_02_selected>February</option>
						        <option value="3" $month_03_selected>March</option>
						        <option value="4" $month_04_selected>April</option>
						        <option value="5" $month_05_selected>May</option>
						        <option value="6" $month_06_selected>June</option>
						        <option value="7" $month_07_selected>July</option>
						        <option value="8" $month_08_selected>August</option>
						        <option value="9" $month_09_selected>September</option>
						        <option value="10" $month_10_selected>October</option>
						        <option value="11" $month_11_selected>November</option>
						        <option value="12" $month_12_selected>December</option>
							</select>
							<select NAME="year" onChange="change_month( 'select' )">
								$start_loop_form_years
					        	<option value="$year" $selected>$year</option>
								$end_loop_form_years
							</select>
						<a href="javascript:change_month( 'next' )" class="calbutton">Next &gt;&gt;</a>
						</form>
					</td>
       	      	</tr>
       	               	  
				          <tr align="center" class="calweekrow">
       	                 <td width="14%">Sunday</td>
       	                 <td width="14%">Monday</td>
       	                 <td width="14%">Tuesday</td>
       	                 <td width="14%">Wednesday</td>
       	                 <td width="14%">Thursday</td>
       	                 <td width="14%">Friday</td>
       	                 <td width="14%">Saturday</td>
                      </tr> 
					$start_loop_weeks
						<tr class="caldayrow" valign="top">
							$start_loop_days
							<td height="50"><span class="caldate">$day</span><br />
								$start_loop_events
									<a href="javascript:show_event_detail( $event_id,'$event_detail_link_url_esc_js' )">$event_title_esc</a><br />
								$end_loop_events
							</td>
							$end_loop_days
						</tr>
					$end_loop_weeks
		</table>
